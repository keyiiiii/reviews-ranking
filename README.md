# reviews-ranking

This GitHub Action ranks reviews of pull requests and sends the results to a Slack Webhook.

![sample.png](img%2Fsample.png)

## Inputs

This Action requires the following inputs:

- `github-token`: Your GitHub token. The default is `${{ github.token }}`. This is not required.
- `slack-webhook-url`: Your Slack Webhook URL. This is required.
- `repository-owner`: The owner of the repository. This is required.
- `repository-name`: The name of the repository. This is required.

## Execution

This Action is executed in the following steps:

1. Checkout this project.
2. Setup Node.js.
3. Generate the reviews ranking. This retrieves the reviews of the last 100 merged pull requests and ranks them. The ranking is generated by the `generateRanking/index.js` script.
4. If a reviews ranking is generated, it sends the results to Slack. This creates a JSON payload containing the ranking and the repository name, and POSTs it to the Slack Webhook.

## Webhook Request

The request sent to the Slack Webhook is a POST request with a JSON payload. The payload contains two properties: `reviewRanking` and `repository`. The `reviewRanking` property contains the ranking of the reviews, and the `repository` property contains the name of the repository.

Here is an example of what the payload might look like:

```json
{
  "reviewRanking": "Ranking results",
  "repository": "your-repository-name"
}
```

Slack Webhook Workflow
To create a workflow that starts with a webhook in Slack, you can follow the instructions in this [Slack documentation](https://slack.com/help/articles/360041352714-Create-workflows-that-start-with-a-webhook).

## Usage

To use this Action, add it to a workflow file in your `.github/workflows` directory like this:

```yaml
on:
  schedule:
    - cron: '0 8 * * 5' # Change this to your preferred time

jobs:
  reviews_ranking:
    runs-on: ubuntu-latest
    steps:
    - name: Reviews Ranking
      uses: keyiiiii/reviews-ranking@v1
      with:
        github-token: ${{ secrets.GITHUB_TOKEN }} # optional
        slack-webhook-url: ${{ secrets.SLACK_WEBHOOK_URL }}
        repository-owner: 'your-repository-owner'
        repository-name: 'your-repository-name'
```

In this example, `GITHUB_TOKEN` and `SLACK_WEBHOOK_URL` are retrieved from the repository's secrets. Also, `repository-owner` and `repository-name` specify the owner and name of the target repository.